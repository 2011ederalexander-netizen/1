<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Ultra Battle Royale FPS</title>
<style>
body {
    margin: 0;
    background: #000;
    overflow: hidden;
    touch-action: none;
    font-family: Arial;
}
#hud {
    position: fixed;
    top: 10px;
    left: 10px;
    color: white;
    z-index: 10;
}
#crosshair {
    position: fixed;
    width: 20px;
    height: 20px;
    margin-left: -10px;
    margin-top: -10px;
    pointer-events: none;
    z-index: 10;
}
#crosshair::before, #crosshair::after {
    content: '';
    position: absolute;
    background: white;
}
#crosshair::before { width: 2px; height: 20px; left: 9px; }
#crosshair::after { width: 20px; height: 2px; top: 9px; }

.enemy { position: absolute; width: 30px; height: 30px; background: red; }
.medkit { position: absolute; width: 25px; height: 25px; background: lime; }
.chest { position: absolute; width: 30px; height: 30px; background: gold; border: 2px solid #aa0; }

#joystick {
    position: fixed; bottom: 20px; left: 20px;
    width: 120px; height: 120px;
    border-radius: 50%;
    background: rgba(255,255,255,.1);
    z-index: 10;
}
#stick {
    position: absolute; left: 40px; top: 40px;
    width: 40px; height: 40px;
    border-radius: 50%;
    background: rgba(255,255,255,.5);
}

#weapon {
    position: fixed; bottom: 20px; right: 20px;
    color: white; z-index: 10;
}

#zone {
    position: fixed;
    border: 4px solid purple;
    border-radius: 50%;
    pointer-events: none;
    z-index: 1;
}

#musicBtn {
    position: fixed;
    top: 10px;
    right: 10px;
    z-index: 10;
}
</style>
</head>
<body>

<div id="hud">
‚ù§Ô∏è Vida: <span id="vida">100</span><br>
üíÄ Kills: <span id="kills">0</span>
</div>

<div id="crosshair"></div>
<div id="weapon">üî´ Pistola</div>
<div id="joystick"><div id="stick"></div></div>
<div id="zone"></div>

<button id="musicBtn">üéµ M√∫sica</button>

<!-- üéµ M√öSICA -->
<audio id="music" loop>
  <source src="https://cdn.pixabay.com/audio/2022/03/15/audio_38c9a5b3df.mp3" type="audio/mpeg">
</audio>

<script>
// ===== VARIABLES =====
let vida = 100, kills = 0;
let px = innerWidth / 2, py = innerHeight / 2;
let miraX = px, miraY = py;
let moveX = 0, moveY = 0;
let enemigos = [], botiquines = [], cofres = [];
let zonaSize = Math.min(innerWidth, innerHeight);

// ===== ARMAS =====
const armas = [
 {nombre:"Pistola", da√±o:25},
 {nombre:"Rifle", da√±o:40},
 {nombre:"Escopeta", da√±o:70}
];
let armaActual = 0;

// ===== ELEMENTOS =====
const vidaSpan = document.getElementById("vida");
const killsSpan = document.getElementById("kills");
const crosshair = document.getElementById("crosshair");
const weaponDiv = document.getElementById("weapon");
const zone = document.getElementById("zone");

// ===== M√öSICA =====
const music = document.getElementById("music");
const musicBtn = document.getElementById("musicBtn");
let musicOn = false;

musicBtn.onclick = () => {
    if (!musicOn) {
        music.volume = 0.4;
        music.play();
        musicOn = true;
        musicBtn.textContent = "‚è∏ M√∫sica";
    } else {
        music.pause();
        musicOn = false;
        musicBtn.textContent = "üéµ M√∫sica";
    }
};

// ===== MIRA =====
document.addEventListener("mousemove", e => { miraX = e.clientX; miraY = e.clientY; });
document.addEventListener("touchmove", e => {
    miraX = e.touches[0].clientX;
    miraY = e.touches[0].clientY;
});

// ===== DISPARO =====
function disparar() {
    enemigos.forEach((e,i)=>{
        const r=e.getBoundingClientRect();
        if(miraX>r.left&&miraX<r.right&&miraY>r.top&&miraY<r.bottom){
            e.dataset.vida-=armas[armaActual].da√±o;
            if(e.dataset.vida<=0){
                e.remove(); enemigos.splice(i,1);
                kills++; killsSpan.textContent=kills;
            }
        }
    });
}
document.addEventListener("click",disparar);
document.addEventListener("touchstart",disparar);

// ===== JOYSTICK =====
const joystick=document.getElementById("joystick");
const stick=document.getElementById("stick");
joystick.addEventListener("touchmove",e=>{
 const r=joystick.getBoundingClientRect();
 let dx=e.touches[0].clientX-r.left-60;
 let dy=e.touches[0].clientY-r.top-60;
 let d=Math.min(40,Math.hypot(dx,dy));
 let a=Math.atan2(dy,dx);
 stick.style.left=60+Math.cos(a)*d-20+"px";
 stick.style.top=60+Math.sin(a)*d-20+"px";
 moveX=Math.cos(a)*3; moveY=Math.sin(a)*3;
});
joystick.addEventListener("touchend",()=>{
 stick.style.left="40px"; stick.style.top="40px";
 moveX=moveY=0;
});

// ===== ENEMIGOS =====
function crearEnemigo(){
 let e=document.createElement("div");
 e.className="enemy"; e.dataset.vida=100;
 e.style.left=Math.random()*innerWidth+"px";
 e.style.top=Math.random()*innerHeight+"px";
 document.body.appendChild(e); enemigos.push(e);
}
setInterval(crearEnemigo,2000);

// ===== COFRES =====
function crearCofre(){
 let c=document.createElement("div");
 c.className="chest";
 c.style.left=Math.random()*innerWidth+"px";
 c.style.top=Math.random()*innerHeight+"px";
 document.body.appendChild(c);
 cofres.push(c);
}
setInterval(crearCofre,7000);

// ===== ZONA =====
setInterval(()=>{
 zonaSize-=5;
 zone.style.width=zonaSize+"px";
 zone.style.height=zonaSize+"px";
 zone.style.left=(innerWidth-zonaSize)/2+"px";
 zone.style.top=(innerHeight-zonaSize)/2+"px";
 if(Math.hypot(px-innerWidth/2,py-innerHeight/2)>zonaSize/2){
  vida--; vidaSpan.textContent=vida;
 }
},500);

// ===== LOOP =====
setInterval(()=>{
 px+=moveX; py+=moveY;
 crosshair.style.left=miraX+"px";
 crosshair.style.top=miraY+"px";

 cofres.forEach((c,i)=>{
  const r=c.getBoundingClientRect();
  if(Math.abs(px-r.left)<30&&Math.abs(py-r.top)<30){
   if(Math.random()<0.5){
     armaActual=Math.floor(Math.random()*armas.length);
     weaponDiv.textContent="üî´ "+armas[armaActual].nombre;
   } else {
     vida=Math.min(100,vida+40);
     vidaSpan.textContent=vida;
   }
   c.remove(); cofres.splice(i,1);
  }
 });

 if(vida<=0){ alert("GAME OVER\nKills: "+kills); location.reload(); }
},16);
</script>

</body>
</html>
